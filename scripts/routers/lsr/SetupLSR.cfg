configure terminal
!
#configurare le interfacce di loopback
interface Loopback0                     
ip address 1.0.4.1 255.255.0.0
!
interface Loopback1
ip address 1.255.0.4 255.255.255.255
!
#vrf configuration
ip vrf vpnA
rd 100:0
!
#configurare le interfacce di rete
interface GigabitEthernet1/0
mpls ip     
ip address 10.0.14.1 255.255.255.252
no shutdown
!
interface GigabitEthernet2/0
mpls ip
ip address 10.0.24.1 255.255.255.252
no shutdown
!
interface GigabitEthernet3/0
mpls ip
ip address 10.0.34.1 255.255.255.252
no shutdown
!
#configurare ospf
router ospf 1
router-id 1.255.0.4
network 1.255.0.4 0.0.0.0 area 0
network 1.0.4.0 0.0.255.255 area 0
network 10.0.14.0 0.0.0.3 area 0
network 10.0.24.0 0.0.0.3 area 0
network 10.0.34.0 0.0.0.3 area 0
#abilitare ldp
mpls ldp autoconfig 
!
#metto le ip route, funziona ma dobbiamo capire che stiamo facendo e se non servirebbe far funzionare un protocollo diverso
ip route vrf vpnA 10.23.0.0 255.255.255.0 1.255.0.2
ip route vrf vpnA 10.123.0.0 255.255.0.0 1.255.0.3
ip route vrf vpnA 10.23.1.0 255.255.255.0 1.255.0.1
!
#configurare bgp
router bgp 100
network 1.0.0.0
neighbor 1.255.0.1 remote-as 100
neighbor 1.255.0.1 route-reflector-client
neighbor 1.255.0.1 update-source lo1
neighbor 1.255.0.1 next-hop-self
neighbor 1.255.0.2 remote-as 100
neighbor 1.255.0.2 route-reflector-client
neighbor 1.255.0.2 update-source lo1
neighbor 1.255.0.2 next-hop-self
neighbor 1.255.0.3 remote-as 100
neighbor 1.255.0.3 route-reflector-client
neighbor 1.255.0.3 update-source lo1
neighbor 1.255.0.3 next-hop-self

address-family vpnv4
neighbor 1.255.0.1 activate
neighbor 1.255.0.1 send-community extended
neighbor 1.255.0.1 next-hop-self
neighbor 1.255.0.2 activate
neighbor 1.255.0.2 send-community extended
neighbor 1.255.0.2 next-hop-self
neighbor 1.255.0.3 activate
neighbor 1.255.0.3 send-community extended
neighbor 1.255.0.3 next-hop-self
exit-address-family
end
#salvataggio
copy running-config startup-config